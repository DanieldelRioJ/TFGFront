<mat-card class="container">
  <section class="row">
    <article class="col-12 col-lg-7">
      <h4>{{'video.original-video' | translate}}</h4>
      <div class="video-viewer">
        <video #originalVideo src="{{environment.apiUrl}}/videos/{{video?.id}}/media" muted></video>
        <div class="controls">
          <div class="control-container">
            <button mat-stroked-button color="primary" class="play-button" (click)="togglePlay()">
              <fa-icon *ngIf="!playingVideo" class="mr-2" [icon]="playIcon"></fa-icon>
              <fa-icon *ngIf="playingVideo" class="mr-2" [icon]="pauseIcon"></fa-icon>
            </button>
            <div class="seek-container" #seek (click)="updateDisplayer($event)">
              <div class="seek-line" [ngStyle]="{width: actualFrame*100/video?.frame_quantity_adapted+'%'}"></div>
            </div>
            <p class="m-0">{{actualFrame*1000/video?.fps_adapted | date:'mm:ss':'UTC' }}/{{video?.frame_quantity_adapted*1000/video?.fps_adapted | date:'mm:ss':'UTC'}}</p>
          </div>
        </div>
        <canvas #canvas class="canvas w-100 h-100" [hidden]="!boundingBoxesActivated"></canvas>
        <div *ngIf="boundingBoxesActivated" class="w-100 h-100">
          <a *ngFor="let boundingBox of actualAppearances" [hidden]="false"
            [ngStyle]="{borderColor:boundingBox.collision?'red':'green',height:boundingBox.relative_height+'px',width:boundingBox.relative_width+'px',left:boundingBox.relative_col+'px',top:boundingBox.relative_row+'px'}" class="bounding-box"
            routerLink="/videos/{{video.id}}/objects/{{boundingBox.object}}" target="_blank"></a>
        </div>

      </div>
      <div>
        <mat-checkbox [(ngModel)]="boundingBoxesActivated">Desactivate bounding boxes</mat-checkbox>
      </div>

      <button mat-raised-button color="primary" class="mr-2" routerLink="/videos/{{video?.id}}/filter">
        <fa-icon [icon]="filterIcon"></fa-icon>
        {{'video.filter-button' | translate}}
      </button>
      <button mat-raised-button color="primary" class="mr-2" routerLink="/videos/{{video?.id}}/objects">
        <fa-icon [icon]="objectsIcon"></fa-icon>
        {{'video.watch-objects-button' | translate}}
      </button>
      <a mat-raised-button color="primary" class="mr-2" href="{{environment.apiUrl}}/videos/{{video?.id}}/media" download="prueba.mp4">
        <fa-icon [icon]="downloadIcon"></fa-icon>
        {{'video.download-button' | translate}}
      </a>
      <button mat-raised-button color="accent" class="mr-2" routerLink="/videos/{{video?.id}}/settings">
        <fa-icon [icon]="settingsIcon"></fa-icon>
      </button>
    </article>
    <article class="info col-12 col-lg-5">
      <h4>Top View</h4>
      <mat-form-field color="accent">
        <mat-label>Distancia:</mat-label>
        <mat-select>
          <mat-option [value]="1">
            1m
          </mat-option>
          <mat-option [value]="2">
            2m
          </mat-option>
          <mat-option [value]="5">
            5m
          </mat-option>
        </mat-select>
      </mat-form-field>
      <ng-container *ngIf="video?.perspective">
        <app-bird-eye-view [video]="video" [upperLeftLimit]=video.perspective.upper_left_limit [lowerRightLimit]="video.perspective.lower_right_limit" [appearances]="actualAppearances"></app-bird-eye-view>


      </ng-container>
      <div *ngIf="!video?.perspective" class="alert alert-danger" role="alert">
        Para activar vista de pájaro: <b>Ajustes>4 puntos de referencia</b>
      </div>
    </article>
  </section>
  <hr>
  <article class=row>

    <div class=" col-12">
      <h4>Información</h4>
      <p><b>{{'objects.video.title' | translate}}:</b> {{video?.title}}</p>
      <p><b>{{'objects.video.city' | translate}}:</b> {{video?.city}}</p>
      <p><b>{{'objects.video.description' | translate}}:</b></p>
      <p>{{video?.description}}</p>
      <hr>
      <p><b>{{'objects.video.recorded-date' | translate}}:</b> {{video?.recorded_date | date: 'dd/MM/yyyy hh:mm'}}</p>
      <p><b>{{'objects.video.upload-date' | translate}}:</b> {{video?.upload_date | date: 'dd/MM/yyyy hh:mm'}}</p>
      <hr>
      <p><b>{{'objects.video.fps' | translate}}:</b> {{video?.fps}}</p>
      <p><b>{{'objects.video.n-frames' | translate}}:</b> {{video?.frame_quantity}}</p>
      <p><b>{{'objects.video.duration' | translate}}:</b> {{video?.frame_quantity*1000/video?.fps | date:'HH:mm:ss':'UTC'}}</p>

    </div>
  </article>
  <hr>
  <section class="mt-3">
    <h4>{{'video.empty-background' | translate}}</h4>
    <img class="col-md-6 col-12 p-0" *ngIf="video" src="{{environment.apiUrl}}/videos/{{video?.id}}/background">
  </section>
</mat-card>